<?php
$tariff_datas = [];
foreach ($tariff_data as $item) {
    $roomId = $item['room_id'];
    if (!isset($tariff_datas[$roomId])) {
        $tariff_datas[$roomId] = [
            "room_category_name" => $item["room_category_name"],
            "room_category_id" => $item["room_category_id"],
            "room_type_name" => $item["room_type_name"],
            "room_id" => $item["room_id"],
            'max_occupancy'      => (int) $item['max_occupancy'],
            "enterprise_id" => $item["enterprise_id"]
        ];
    }
    $tariff_datas[$roomId]["meal_tariff"][] = [
        "hotel_room_meal_id" => $item["hotel_room_meal_id"],
        "meal_plan_id" => $item["meal_plan_id"],
        "meal_plan_name" => $item["meal_plan_name"],
        "tariff" => $item["tariff"]
    ];
}

$tariff_datas = array_values($tariff_datas);
echo "<script>console.log('Tariff Data Structure:', " . json_encode($tariff_datas) . ");</script>";
?>
<style>
    .table td {
        padding: 0.2rem;
        vertical-align: top;
        border-top: 0;
        word-wrap: break-word;
        white-space: normal;
    }

    input[type="date"],
    input[type="text"],
    label,
    select,
    option {
        font-size: 11px;
    }
</style>
<table class="table table-bordered table-responsive-md table-striped mb-0 text-nowrap">
    <tr>
        <td colspan="2" style="background-color: #c2d6d6;text-align:center;font-weight: bold;">ROOM TYPE / TARIFFS</td>
        <td colspan="2" style="background-color: #c2c2d6;text-align:center;font-weight: bold;">Dinner<input type="text" id="dinner1" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #c2c2d6;text-align:center;font-weight: bold;">Lunch<input type="text" id="lunch1" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #cccccc;text-align:center;font-weight: bold;">Dinner<input type="text" id="dinner2" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #cccccc;text-align:center;font-weight: bold;">Lunch<input type="text" id="lunch2" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #c2c2d6;text-align:center;font-weight: bold;">Dinner<input type="text" id="dinner3" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #c2c2d6;text-align:center;font-weight: bold;">Lunch<input type="text" id="lunch3" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #cccccc;text-align:center;font-weight: bold;">Dinner<input type="text" id="dinner4" class="form-control input-sm" value="0"></td>
        <td colspan="2" style="background-color: #cccccc;text-align:center;font-weight: bold;">Lunch<input type="text" id="lunch4" class="form-control input-sm" value="0"></td>
    </tr>
    <tr>
        <td rowspan="2" style="background-color: #c2d6d6; text-align: center; font-weight: bold; width: 200px; word-wrap: break-word; white-space: normal;">Room Category</td>
        <td rowspan="2" style="background-color: #c2d6d6;text-align:center;font-weight: bold;">Room Type</td>
        <td colspan="4" style="background-color: #c2c2d6;text-align:center;font-weight: bold;">Adult tariff</td>
        <td colspan="4" style="background-color: #cccccc;text-align:center;font-weight: bold;">Child tariff with bed</td>
        <td colspan="4" style="background-color: #c2c2d6;text-align:center;font-weight: bold;">Child tariff without bed</td>
        <td colspan="4" style="background-color: #cccccc;text-align:center;font-weight: bold;">Extra bed tariff</td>
    </tr>
    <tr>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">EP</td>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">CP</td>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">MAP</td>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">AP</td>

        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">EP</td>
        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">CP</td>
        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">MAP</td>
        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">AP</td>

        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">EP</td>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">CP</td>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">MAP</td>
        <td style="background-color: #c2c2d6;text-align:center;font-weight: bold;">AP</td>

        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">EP</td>
        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">CP</td>
        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">MAP</td>
        <td style="background-color: #cccccc;text-align:center;font-weight: bold;">AP</td>
    </tr>
    <?php
    if (!empty($tariff_datas)) {
        foreach ($tariff_datas as $key => $val) { ?>
            <tr>
                <td><input type="checkbox" class="chk_room" value="<?php echo $val['room_id']; ?>"> <?php echo $val['room_category_name']; ?></td>
                <td>
                    <input
                        type="hidden"
                        id="rt<?= $val['room_id'] ?>"
                        value="<?= $val['room_type_name'] ?>">
                    <?= $val['room_type_name'] ?>
                    (max<?= isset($val['max_occupancy']) ? $val['max_occupancy'] : 'â€“' ?>)
                </td>

                <?php
                $index = 1;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index}_{$val['room_id']}";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class mc<?php echo $val['room_id']; ?> ml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                $index = 2;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index}_{$val['room_id']}";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class mc<?php echo $val['room_id']; ?> ml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                $index = 3;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index}_{$val['room_id']}";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class mc<?php echo $val['room_id']; ?> ml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                $index = 4;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index}_{$val['room_id']}";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class mc<?php echo $val['room_id']; ?> ml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                ?>
            </tr>
            <tr>
                <td>Weekends</td>
                <td></td>

                <?php
                $index1 = 1;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index1}_{$val['room_id']}_w";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class wmc<?php echo $val['room_id']; ?> wml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                $index1 = 2;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index1}_{$val['room_id']}_w";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class wmc<?php echo $val['room_id']; ?> wml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                $index1 = 3;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index1}_{$val['room_id']}_w";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class wmc<?php echo $val['room_id']; ?> wml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                $index1 = 4;
                foreach ($val['meal_tariff'] as $key1 => $val1) {
                    $id = "{$val1['meal_plan_name']}_{$index1}_{$val['room_id']}_w";
                ?>
                    <td>
                        <input type="text" id="<?php echo $id; ?>" class="form-control input-sm meal_class wmc<?php echo $val['room_id']; ?> wml<?php echo $val1['hotel_room_meal_id']; ?>" data-id="<?php echo $id; ?>" value="0" readonly>
                    </td>
                <?php
                }

                ?>
            </tr>
    <?php
        }
    }
    ?>
</table>
<br>
<button type="button" id="btn_save_all_tariff" class="btn btn-success" style="float:right;">Save All</button>
<span id="tariff-alert"></span>
<script>
    $(document).ready(function() {
        $(document).on("input", '#dinner1', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var dinnerValue = parseInt($(this).val()) || 0;
            //var lunchValue = parseInt($('#lunch1').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[2]['hotel_room_meal_id'];
                var element_id = "MAP_1_" + room_id;
                var cp_id = "CP_1_" + room_id;

                var element_id_w = "MAP_1_" + room_id + "_w";
                var cp_id_w = "CP_1_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                var cpval = parseInt($('#' + cp_id).val()) || 0;
                var maxOcc = parseInt(data.max_occupancy, 10) || 4;
                if (data.room_type_name == "Double") {
                    $('#' + element_id).val((dinnerValue * maxOcc) + cpval);
                    $('#' + element_id_w).val((dinnerValue * maxOcc) + cpval_w);
                } else {
                    $('#' + element_id).val(dinnerValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + cpval_w);
                }
            });
        });
    });

    $(document).ready(function() {
        $(document).on("input", '#dinner2', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var dinnerValue = parseInt($(this).val()) || 0;
            //var lunchValue = parseInt($('#lunch2').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[2]['hotel_room_meal_id'];
                var element_id = "MAP_2_" + room_id;
                var cp_id = "CP_2_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "MAP_2_" + room_id + "_w";
                var cp_id_w = "CP_2_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                if (data.room_type_name == "Double") {
                    $('#' + element_id).val(dinnerValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + cpval_w);
                }
            });
        });
    });

    $(document).ready(function() {
        $(document).on("input", '#dinner3', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var dinnerValue = parseInt($(this).val()) || 0;
            //var lunchValue = parseInt($('#lunch3').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[2]['hotel_room_meal_id'];
                var element_id = "MAP_3_" + room_id;
                var cp_id = "CP_3_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "MAP_3_" + room_id + "_w";
                var cp_id_w = "CP_3_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                if (data.room_type_name == "Double") {
                    $('#' + element_id).val(dinnerValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + cpval_w);
                }
            });
        });
    });

    $(document).ready(function() {
        $(document).on("input", '#dinner4', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var dinnerValue = parseInt($(this).val()) || 0;
            //var lunchValue = parseInt($('#lunch4').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[2]['hotel_room_meal_id'];
                var element_id = "MAP_4_" + room_id;
                var cp_id = "CP_4_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "MAP_4_" + room_id + "_w";
                var cp_id_w = "CP_4_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                if (data.room_type_name == "Double") {
                    $('#' + element_id).val(dinnerValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + cpval_w);
                }
            });
        });
    });
</script>


<script>
    $(document).ready(function() {
        $(document).on("input", '#lunch1', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var lunchValue = parseInt($(this).val()) || 0;
            var dinnerValue = parseInt($('#dinner1').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[3]['hotel_room_meal_id'];
                var element_id = "AP_1_" + room_id;
                var cp_id = "CP_1_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "AP_1_" + room_id + "_w";
                var cp_id_w = "CP_1_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;
                var maxOcc = parseInt(data.max_occupancy, 10) || 4;

                if (data.room_type_name == "Double") {
                    var vals = (dinnerValue + lunchValue) * maxOcc;
                    $('#' + element_id).val(vals + cpval);
                    $('#' + element_id_w).val(vals + cpval_w);
                } else {
                    $('#' + element_id).val(dinnerValue + lunchValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + lunchValue + cpval_w);
                }
            });
        });
    });

    $(document).ready(function() {
        $(document).on("input", '#lunch2', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var lunchValue = parseInt($(this).val()) || 0;
            var dinnerValue = parseInt($('#dinner2').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[3]['hotel_room_meal_id'];
                var element_id = "AP_2_" + room_id;
                var cp_id = "CP_2_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "AP_2_" + room_id + "_w";
                var cp_id_w = "CP_2_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                if (data.room_type_name == "Double") {
                    $('#' + element_id).val(dinnerValue + lunchValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + lunchValue + cpval_w);
                }
            });
        });
    });

    $(document).ready(function() {
        $(document).on("input", '#lunch3', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var lunchValue = parseInt($(this).val()) || 0;
            var dinnerValue = parseInt($('#dinner3').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[3]['hotel_room_meal_id'];
                var element_id = "AP_3_" + room_id;
                var cp_id = "CP_3_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "AP_3_" + room_id + "_w";
                var cp_id_w = "CP_3_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                if (data.room_type_name == "Double") {
                    $('#' + element_id).val(dinnerValue + lunchValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + lunchValue + cpval_w);
                }
            });
        });
    });

    $(document).ready(function() {
        $(document).on("input", '#lunch4', function() {
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var lunchValue = parseInt($(this).val()) || 0;
            var dinnerValue = parseInt($('#dinner4').val()) || 0;
            $.each(tariff_datas, function(index, data) {
                var room_id = data.room_id;
                var meal_id = data.meal_tariff[3]['hotel_room_meal_id'];
                var element_id = "AP_4_" + room_id;
                var cp_id = "CP_4_" + room_id;
                var cpval = parseInt($('#' + cp_id).val()) || 0;

                var element_id_w = "AP_4_" + room_id + "_w";
                var cp_id_w = "CP_4_" + room_id + "_w";
                var cpval_w = parseInt($('#' + cp_id_w).val()) || 0;

                if (data.room_type_name == "Double") {
                    $('#' + element_id).val(dinnerValue + lunchValue + cpval);
                    $('#' + element_id_w).val(dinnerValue + lunchValue + cpval_w);
                }
            });
        });
    });
</script>
<script>
    $(document).ready(function() {
        // 1) Cache your PHP data once
        var tariffDatas = <?php echo json_encode($tariff_datas, JSON_HEX_TAG); ?>;

        // 2) Helper: recalc a single row given its index, room_id, and optional "_w" suffix
        function recalcRow(part, roomId, suffix) {
            var cpVal = parseInt($('#CP_' + part + '_' + roomId + suffix).val(), 10) || 0;
            var dinnerVal = parseInt($('#dinner' + part).val(), 10) || 0;
            var lunchVal = parseInt($('#lunch' + part).val(), 10) || 0;
            // lookup max occupancy
            // lookup max occupancy
var room = tariffDatas.find(d => d.room_id.toString() === roomId.toString()) || {};
var occ = parseInt(room.max_occupancy, 10);
var maxOcc = (isNaN(occ) || occ < 1) ? 1 : occ;

// only part 1 (adult) gets multiplied by occupancy; the others use 1
var occFactor = (part === '1' ? maxOcc : 1);

// compute MAP & AP with the correct factor
var newMAP = (dinnerVal * occFactor) + cpVal;
var newAP  = ((dinnerVal + lunchVal) * occFactor) + cpVal;


            // write them back
            $('#MAP_' + part + '_' + roomId + suffix).val(newMAP);
            $('#AP_' + part + '_' + roomId + suffix).val(newAP);
        }

        // 3) Single handler: only fire on CP, dinner or lunch edits
        $(document).on('input', '.meal_class', function() {
            // data-id examples: "CP_1_8347", "dinner_2_8347_w", "lunch_3_8347"
            var rawId = $(this).data('id');
            var parts = rawId.split('_');
            var type = parts[0]; // "CP", "dinner" or "lunch"

            // ignore MAP/AP edits
            if (!/^(?:CP|dinner|lunch)$/.test(type)) {
                return;
            }

            var part = parts[1]; // row index (1â€“4)
            var roomId = parts[2]; // your room_id
            var suffix = parts.length === 4 ? '_w' : ''; // weekend if 4th segment

            // recalc only that row
            recalcRow(part, roomId, suffix);
        });
    });
</script>



</script>
<script>
    // $(document).ready(function() {

    //     $('.chk_room').on('change', function() {
    //         var roomId = $(this).val();
    //         var isChecked = $(this).is(':checked'); // Check if the checkbox is checked
    //         $('.mc' + roomId).prop('readonly', !isChecked);
    //         $('.wmc' + roomId).prop('readonly', !isChecked);
    //     });
    // });

    //NJ//
    $(document).ready(function() {
        // cache your PHP array once
        const tariff_datas = <?php echo json_encode($tariff_datas, JSON_HEX_TAG); ?>;

        $('.chk_room').on('change', function() {
            const roomId = $(this).val();
            const isChecked = $(this).is(':checked');
            // find that room in your JS data
            const roomData = tariff_datas.find(d => d.room_id.toString() === roomId.toString()) || {};

            // handle both weekday (.mc) and weekend (.wmc) inputs together
            $(`.mc${roomId}, .wmc${roomId}`).each(function() {
                const part = parseInt(this.id.split('_')[1], 10); // 1=Adult, 2=Child bed, etc.
                const isSingle = roomData.room_type_name === 'Single';
                // editable if checked AND (not single OR it's the adult field)
                const editable = isChecked && (!isSingle || part === 1);
                $(this).prop('readonly', !editable);
            });
        });
    });

    ///
</script>
<script>
    $(document).ready(function() {
        $(document).on("click", '#btn_save_all_tariff', function() {
            var object_id = "<?php echo $object_id; ?>";
            var tariff_datas = <?php echo json_encode($tariff_datas); ?>;
            var season_id = $('#season_id').val();
            var weekends_id = $('#weekends_id').val();
            var room_id;
            var ep_adult;
            var ep_child;
            var ep_child_wb;
            var ep_extra;
            var tariff = 0;
            var child_tariff = 0;
            var child_wb_tariff = 0;
            var extra_tariff = 0;
            var flag = 0;
            var dinner_adult = $('#dinner1').val();
            var lunch_adult = $('#lunch1').val();
            var dinner_child = $('#dinner2').val();
            var lunch_child = $('#lunch2').val();
            var dinner_child_wb = $('#dinner3').val();
            var lunch_child_wb = $('#lunch3').val();
            var dinner_extra = $('#dinner4').val();
            var lunch_extra = $('#lunch4').val();
            if (season_id == '' || season_id == null || season_id == 'undefined') {
                alert("Please select Season");
            } else {
                $.each(tariff_datas, function(index, data) {
                    room_id = data.room_id;

                    for (var i = 0; i < 4; i++) {
                        var hotel_room_meal_id = data.meal_tariff[i]['hotel_room_meal_id'];
                        if (i == 0) {
                            ep_adult = "EP_1_" + room_id;
                            ep_child = "EP_2_" + room_id;
                            ep_child_wb = "EP_3_" + room_id;
                            ep_extra = "EP_4_" + room_id;

                            ep_adult_w = "EP_1_" + room_id + "_w";
                            ep_child_w = "EP_2_" + room_id + "_w";
                            ep_child_wb_w = "EP_3_" + room_id + "_w";
                            ep_extra_w = "EP_4_" + room_id + "_w";
                        }
                        if (i == 1) {
                            ep_adult = "CP_1_" + room_id;
                            ep_child = "CP_2_" + room_id;
                            ep_child_wb = "CP_3_" + room_id;
                            ep_extra = "CP_4_" + room_id;

                            ep_adult_w = "CP_1_" + room_id + "_w";
                            ep_child_w = "CP_2_" + room_id + "_w";
                            ep_child_wb_w = "CP_3_" + room_id + "_w";
                            ep_extra_w = "CP_4_" + room_id + "_w";
                        }
                        if (i == 2) {
                            ep_adult = "MAP_1_" + room_id;
                            ep_child = "MAP_2_" + room_id;
                            ep_child_wb = "MAP_3_" + room_id;
                            ep_extra = "MAP_4_" + room_id;

                            ep_adult_w = "MAP_1_" + room_id + "_w";
                            ep_child_w = "MAP_2_" + room_id + "_w";
                            ep_child_wb_w = "MAP_3_" + room_id + "_w";
                            ep_extra_w = "MAP_4_" + room_id + "_w";
                        }
                        if (i == 3) {
                            ep_adult = "AP_1_" + room_id;
                            ep_child = "AP_2_" + room_id;
                            ep_child_wb = "AP_3_" + room_id;
                            ep_extra = "AP_4_" + room_id;

                            ep_adult_w = "AP_1_" + room_id + "_w";
                            ep_child_w = "AP_2_" + room_id + "_w";
                            ep_child_wb_w = "AP_3_" + room_id + "_w";
                            ep_extra_w = "AP_4_" + room_id + "_w";
                        }

                        tariff = $('#' + ep_adult).val();
                        child_tariff = $('#' + ep_child).val();
                        child_wb_tariff = $('#' + ep_child_wb).val();
                        extra_tariff = $('#' + ep_extra).val();

                        tariff_w = $('#' + ep_adult_w).val();
                        child_tariff_w = $('#' + ep_child_w).val();
                        child_wb_tariff_w = $('#' + ep_child_wb_w).val();
                        extra_tariff_w = $('#' + ep_extra_w).val();


                        $.ajax({
                            url: '<?= site_url('Dashboard/saveRoomfunctionSeason'); ?>',
                            method: 'POST',
                            data: {
                                object_id: object_id,
                                hotel_room_meal_id: hotel_room_meal_id,
                                tariff: tariff,
                                season_id: season_id,
                                child_tariff: child_tariff,
                                child_wb_tariff: child_wb_tariff,
                                extra_tariff: extra_tariff,

                                tariff_w: tariff_w,
                                weekends_id: weekends_id,
                                child_tariff_w: child_tariff_w,
                                child_wb_tariff_w: child_wb_tariff_w,
                                extra_tariff_w: extra_tariff_w,

                                dinner_adult: dinner_adult,
                                lunch_adult: lunch_adult,
                                dinner_child: dinner_child,
                                lunch_child: lunch_child,
                                dinner_child_wb: dinner_child_wb,
                                lunch_child_wb: lunch_child_wb,
                                dinner_extra: dinner_extra,
                                lunch_extra: lunch_extra
                            },
                            dataType: 'json',
                            success: function(response) {
                                if (response.status == 1) {
                                    var alerttHTML = `<div class="alert alert-success alert-dismissible fade show" role="alert">
                                        <span class="alert-inner--icon"><i class="fe fe-info"></i></span>
                                        <span class="alert-inner--text">Tariff Updated</span>
                                        <button type="button" class="close text-white" data-dismiss="alert" aria-label="Close">
                                            <span aria-hidden="true">Ã—</span>
                                        </button>
                                    </div>`;

                                    $('#tariff-alert').html(alerttHTML);
                                    setTimeout(function() {
                                        $(".alert").fadeOut("slow", function() {
                                            $(this).remove();
                                        });
                                    }, 2000);
                                    location.reload()
                                } else {
                                    //alert("Please try later");
                                }
                            },
                            error: function(xhr, status, error) {
                                console.error('Error adding node:', error);
                            }
                        });
                    }
                });

            }
        });
    });
</script>